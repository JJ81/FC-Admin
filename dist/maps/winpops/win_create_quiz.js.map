{"version":3,"sources":["winpops/win_create_quiz.js"],"names":["window","requirejs","Util","getRandomString","getSessionCount","id","courseId","$","val","axios","get","params","QuizService","require","btnAddQuizTypeC","ui","button","rootContainer","btnAddQuizTypeB","quizContainer","document","getElementById","btnRegistQuiz","wrapper","all","course_list_id","res1","res2","quiz_group_id","quiz_list","type","data","course_id","alert","parent","opener","winpop_listener","session_count","options","result","placeholder","handle","close","sortable","update","connectWith","newIndex","oldIndex","removeAttr","zIndex","moveQuizIndexes","this","attr","item","index","e","addQuizSingleAnswer","addQuizMultiOptionWithOneAnswer","addQuizMultiOptionWithMultiAnswer","bind","saveSessionAndQuiz"],"mappings":"AAAA,YACAA,QAAOC,WAML,SAHE,gBAMFD,SAAAE,GAgBA,QAAAC,KACA,MAASC,QAAAA,MAAAA,IAAT,kCAIMC,QAAAA,KADM,GAAAC,GAAAN,OAAAO,EAAA,yBAAAC,KADsC,OAAhDR,QAAAS,MAAAC,IAAA,wBAKDC,QAHKN,GAAIC,KAxBV,GAAIM,GAAcC,QAAQ,eAO1Bb,QAAIc,EAAAA,OAAAA,OAAkBd,WAASA,OAAAO,EAAAQ,GAAAC,OAE/B,IAAIC,GAAgBjB,OAASO,EAAA,mBAHzBW,EAAkBlB,OAAOO,EAAE,mBAK3BY,EAAgBC,OAASC,EAAAA,mBAC7BC,EAAAtB,OAAAO,EAAA,gBAHIU,EAAgBjB,OAAOO,EAAE,eAM7BY,EAAShB,SAAmBkB,eAAA,iBAsBtBE,QAAAA,EAAAA,WAFYvB,OAAdS,MAAAe,KAJArB,IASAC,MAEEqB,KAAAA,OAAAA,MAAAA,OAFS,SAAAC,EAAAC,GAGTC,GAAAA,IACAC,aAAWZ,EACXa,QAAMb,GALRc,GACEC,UAAWhC,OAAOO,EAAE,yBAAyBC,MAS/CI,eAAkBA,KAChBgB,cAAAF,EAAAK,KAAA1B,GACAL,UAAOiC,KACPH,KAAAb,EAAAc,KAAA,QACA/B,MAAOkC,OAAOC,EAAAA,UAAOC,MACrBC,cAAAV,EAAAI,KAAAM,cAzBJzB,GAAA,GAAAA,GAAA0B,EAAAP,EAAA,SAAAQ,GAsBIvC,OAAOiC,MAAM,gBAUjBO,OAAAA,OAAaL,OAAAC,kBAEbK,OAAQC,eAKP1C,OARqCO,EAAA,sBAAAoC,UAStCC,YAAQ,iBACNC,YAAIC,qBACJL,OAAIM,cACJ/C,sBAAegD,EACLC,OAAA,OACVrC,MAAAA,SAAYsC,EAAAA,GACblD,OAAAO,EAAA4C,MAAAC,KAAA,iBAAArC,EAAAsC,KAAAC,UANDV,OAAQ,SAAUW,EAAGxC,GASvB,GAAA+B,GAAA/B,EAAAsC,KAAAC,QAPQP,EAAW/C,OAAOO,EAAE4C,MAAMC,KAAK,iBACnCpD,QAAOO,EAAE4C,MAAMH,WAAW,kBAU5BpC,EAAY4C,gBAAAA,EAAZV,MAOAlC,EAAY6C,KAAAA,QAAAA,WADd7C,EAAA4C,wBAQE5C,EAAY8C,KAAAA,QAAAA,WADd9C,EAAA6C,oCAQAnC,EAAcqC,KAAK,QAAS,WAC1B/C,EAAYgD,sCADdtC,EAAcqC,KAAK,QAAS,WAC1B/C,EAAYgD","file":"winpops/win_create_quiz.js","sourcesContent":["'use strict';\nwindow.requirejs(\n  [\n    'common',\n    'quiz_service'\n  ],\nfunction (Util) {\n  var QuizService = require('quiz_service');\n\n  // avoid to confliction between jquery tooltip and bootstrap tooltip\n  window.$.widget.bridge('uibutton', window.$.ui.button);\n\n  var btnAddQuizTypeA = window.$('#btn-add-quiz-a'); // 단답형\n  var btnAddQuizTypeB = window.$('#btn-add-quiz-b'); // 선택형\n  var btnAddQuizTypeC = window.$('#btn-add-quiz-c'); // 다답형\n  var btnRegistQuiz = window.$('#regist-quiz'); // 등록\n  var rootContainer = window.$('#createQuiz');\n\n  var quizContainer = document.getElementById('quiz-container');\n  // var _confirm = true; // 윈도우 종료 시 창을 닫을지 여부\n\n  // 랜덤 문자열을 생성한다.\n  function getRandomString () {\n    return window.axios.get('/api/v1/course/group/id/create');\n  }\n\n  // 강의 세션수를 조회한다.\n  function getSessionCount () {\n    var courseId = window.$('input[name=course_id]').val();\n    return window.axios.get('/course/sessioncount', {\n      params: {\n        id: courseId\n      }\n    });\n  }\n\n  window.$(function () {    \n    window.axios.all([\n      getRandomString(),\n      getSessionCount()\n    ])\n    .then(window.axios.spread(function (res1, res2) {\n      var options = {\n        root_wrapper: rootContainer,\n        wrapper: quizContainer\n      };\n\n      var data = {\n        course_id: window.$('input[name=course_id]').val(),\n        course_list_id: null,\n        quiz_group_id: res1.data.id,\n        quiz_list: null,\n        type: rootContainer.data('type'), // QUIZ/FINAL\n        title: window.$('#title').val(),\n        session_count: res2.data.session_count\n      };\n\n      QuizService = new QuizService(options, data, function (result) {\n        // 퀴즈 등록시 호출된다.\n        window.alert('퀴즈를 등록하였습니다.');\n        // window.parent.opener.location.reload(); // 부모폼을 reload 한다.\n        window.parent.opener.winpop_listener();\n        // _confirm = false;\n        window.close();\n      });\n    }));\n  });\n\n  window.$('.connectedSortable').sortable({\n    placeholder: 'sort-highlight',\n    connectWith: '.connectedSortable',\n    handle: '.box-header',\n    forcePlaceholderSize: true,\n    zIndex: 999999,\n    start: function (e, ui) {\n      window.$(this).attr('data-previndex', ui.item.index());\n    },\n    update: function (e, ui) {\n      var newIndex = ui.item.index();\n      var oldIndex = window.$(this).attr('data-previndex');\n      window.$(this).removeAttr('data-previndex');\n                // console.log('newIndex : ' + newIndex + ' oldIndex : ' + oldIndex);\n      QuizService.moveQuizIndexes(oldIndex, newIndex);\n    }\n  });\n\n  /**\n   * 단덥형 퀴즈 생성\n   */\n  btnAddQuizTypeA.bind('click', () => {\n    QuizService.addQuizSingleAnswer();\n  });\n\n  /**\n   * 선택형 퀴즈 생성\n   */\n  btnAddQuizTypeB.bind('click', () => {\n    QuizService.addQuizMultiOptionWithOneAnswer();\n  });\n\n  /**\n   * 다답형 퀴즈 생성\n  */\n  btnAddQuizTypeC.bind('click', () => {\n    QuizService.addQuizMultiOptionWithMultiAnswer();\n  });\n\n  /**\n   * 퀴즈 일체를 등록한다.\n   *\n   */\n  btnRegistQuiz.bind('click', () => {\n    QuizService.saveSessionAndQuiz();\n  });\n}); // end of func\n"],"sourceRoot":"/source/"}