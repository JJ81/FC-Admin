{"version":3,"sources":["winpops/win_modify_quiz.js"],"names":["requirejs","Util","quiz_group_id","axios","get","params","quizGroupId","options","root_wrapper","wrapper","then","spread","res","data","quiz_list","window","QuizService","course_list_id","course_list_order","courseListId","type","_type","alert","_title","opener","result","parent","location","reload","_confirm","close","$","widget","require","btnAddQuizTypeA","ui","button","btnModifyQuiz","rootContainer","quizContainer","document","courseId","val","createQuizService","handle","sortable","forcePlaceholderSize","zIndex","start","update","e","this","newIndex","item","index","removeAttr","moveQuizIndexes","oldIndex","bind","btnAddQuizTypeB","btnAddQuizTypeC","addQuizMultiOptionWithMultiAnswer","saveSessionAndQuiz"],"mappings":"AAAA,YACAA,YAAAA,SAKI,gBADJ,SAAUC,GA+DFC,QAAAA,KADM,MAAAC,OAAAC,IAAA,oBADVC,QAKDH,cAAAI,KAYG,QAAIC,KACFC,MAAAA,KACAC,MAJHC,KAAKP,MAAMQ,OAAO,SAAUC,GAO3B,GAAIC,GAAOD,EAAAC,KAAAC,SAgBTC,GAAA,GAAAC,IAdAC,aAAAA,EACAf,QAAAA,IAIAgB,UAAAA,EAPFD,eAAAE,EAGEjB,cAAeI,EAOjBU,UAAAA,EACEI,KAAAC,EACAC,MAAMC,EACNR,kBAAcS,GAGd,SAAAC,GA1BJH,MAAA,gBA6BDP,OAAAW,OAAAF,OAAAG,SAAAC,SAEDC,GAAA,EALMd,OAAOe,aA9FbC,GAAEC,GAAcC,QAAhB,eAGAF,GAAAC,OAAIE,OAAAA,WAAoBH,EAAAI,GAAAC,OAGxB,IAAIC,GAAkBN,EAAA,mBAClBO,EAAkBP,EAAA,mBAClBQ,EAAgBC,EAAAA,mBAFhBH,EAAgBN,EAAE,gBAIlBU,EAAaV,EAAA,eACbZ,EAAemB,SAAAA,eAAmB,kBAElChC,EAAAA,EAAAA,yBAAiCoC,MACjCrB,EAAQiB,EAAmBzB,KAA/B,kBACIU,EAAWe,EAAfzB,KAAA,qBACIgB,EAAWS,EAAMzB,KAAA,iBAFjBQ,EAAQiB,EAAczB,KAAK,QAI/BU,EAAAQ,EAAA,UAAAW,MAFIb,GAAW,CAYfE,GAAE,WAIIY,MAIJC,EAAAA,sBAH+BC,UAI/BC,YAAAA,iBACAC,YAAQ,qBACRC,OAAO,cACLjB,sBAAa,EACdgB,OAR8B,OAS/BE,MAAAA,SAAQC,EAAAf,GACNJ,EAAAoB,MAAIC,KAAAA,iBAAJjB,EAAAkB,KAAAC,UAEAvB,OAAA,SAAQwB,EAAWpB,GACT,GAAAiB,GAAAjB,EAAAkB,KAAAC,QACVtC,EAAYwC,EAAAA,MAAAA,KAAgBC,iBAC7B1B,GAAAoB,MAAAI,WAAA,kBADCvC,EAAYwC,gBAAgBC,EAAUL,MAuD1ClB,EAAgBwB,KAAK,QAAS,WAO9BC,EAAAA,wBAAAA,EAAgBD,KAAK,QAAS,WAO9BE,EAAAA,oCAAAA,EAAgBF,KAAK,QAAS,WAC5B1C,EAAY6C,sCAOdxB,EAAcqB,KAAK,QAAS,WAC1B1C,EAAY8C","file":"winpops/win_modify_quiz.js","sourcesContent":["'use strict';\nrequirejs([\n  'common',\n  'quiz_service'\n],\nfunction (Util) {\n    // 퀴즈 서비스\n  var QuizService = require('quiz_service');\n\n  // avoid to confliction between jquery tooltip and bootstrap tooltip\n  $.widget.bridge('uibutton', $.ui.button);\n\n    // cache\n  var btnAddQuizTypeA = $('#btn-add-quiz-a'); // 단답형\n  var btnAddQuizTypeB = $('#btn-add-quiz-b'); // 선택형\n  var btnAddQuizTypeC = $('#btn-add-quiz-c'); // 다답형\n  var btnModifyQuiz = $('#modify-quiz'); // 등록\n  var rootContainer = $('#modifyQuiz');     // winpopup container\n  var quizContainer = document.getElementById('quiz-container');  // quiz container\n\n  var courseId = $('input[name=course_id]').val();\n  var courseListId = rootContainer.data('course-list-id');\n  var courseListOrder = rootContainer.data('course-list-order');\n  var quizGroupId = rootContainer.data('quiz-group-id');\n  var _type = rootContainer.data('type');\n  var _title = $('#title').val();\n  var _confirm = true; // 윈도우 종료 시 창을 닫을지 여부\n\n  /**\n   * 모듈 초기화\n   *\n   * TODO\n   * 1. course_list_id 를 알아야한다.\n   * 2. QuizService 에게 데이터 조회를 위한 키값들을 전달한다.\n   * 3. QuizService 에서 데이터를 조회한다.\n   * 3. QuizService 에서 조회한 데이터를 통해 QuizComponent 를 생성한다.\n   * 4. 각각의 QuizComponent 에서는 자신을 수정,삭제할 수 있다.\n   */\n  $(function () {\n    createQuizService();\n  });\n\n        // jQuery UI sortable 초기화\n  $('.connectedSortable').sortable({\n    placeholder: 'sort-highlight',\n    connectWith: '.connectedSortable',\n    handle: '.box-header',\n    forcePlaceholderSize: true,\n    zIndex: 999999,\n    start: function (e, ui) {\n      $(this).attr('data-previndex', ui.item.index());\n    },\n    update: function (e, ui) {\n      var newIndex = ui.item.index();\n      var oldIndex = $(this).attr('data-previndex');\n      $(this).removeAttr('data-previndex');\n                // console.log('newIndex : ' + newIndex + ' oldIndex : ' + oldIndex);\n      QuizService.moveQuizIndexes(oldIndex, newIndex);\n    }\n  });\n\n  /**\n   * 퀴즈 목록을 조회한다.\n   *\n   */\n  function getQuizList () {\n    return axios.get('/api/v1/quizlist', {\n      params: {\n        quiz_group_id: quizGroupId\n      }\n    });\n  }\n\n  /**\n   * QuizService 를 생성한다.\n   *\n   */\n  function createQuizService () {\n    axios.all([\n      getQuizList()\n    ])\n    .then(axios.spread(function (res) {\n      var quiz_list = res.data.quiz_list;\n      var options = {\n        root_wrapper: rootContainer,\n        wrapper: quizContainer\n      };\n\n      var data = {\n        course_id: courseId,\n        course_list_id: courseListId,\n        quiz_group_id: quizGroupId,\n        quiz_list: quiz_list,\n        type: _type, // QUIZ/FINAL\n        title: _title,\n        course_list_order: courseListOrder\n      };\n\n      QuizService = new QuizService(options, data, function (result) {\n        // 퀴즈 등록시 호출된다.\n        alert('자료를 수정하였습니다.');\n        window.parent.opener.location.reload(); // 부모폼을 reload 한다.\n\n        _confirm = false;\n        window.close();\n      });\n    }));\n  }\n\n  /**\n   * 단덥형 퀴즈 생성\n   */\n  btnAddQuizTypeA.bind('click', function () {\n    QuizService.addQuizSingleAnswer();\n  });\n\n  /**\n   * 선택형 퀴즈 생성\n   */\n  btnAddQuizTypeB.bind('click', function () {\n    QuizService.addQuizMultiOptionWithOneAnswer();\n  });\n\n  /**\n   * 다답형 퀴즈 생성\n   */\n  btnAddQuizTypeC.bind('click', function () {\n    QuizService.addQuizMultiOptionWithMultiAnswer();\n  });\n\n  /**\n   * 퀴즈 일체를 수정한다.\n   *\n   */\n  btnModifyQuiz.bind('click', function () {\n    QuizService.saveSessionAndQuiz();\n  });\n});\n"],"sourceRoot":"/source/"}